%\documentclass{standalone}
%\usepackage{rotating}	%% introduce sideways env
%\usepackage{tikz}
%
%%% Public TikZ libraries
%\usetikzlibrary{positioning}
%\usetikzlibrary{shapes}
%
%%% Custom TikZ addons
%\usetikzlibrary{crypto.symbols}
%\tikzset{shadows=no}        % Option: add shadows to XOR, ADD, etc.
%
%%% Document
%\begin{document}
\begin{tikzpicture}[scale=0.4]
	\path[anchor=east] (-1,0.5) node {$pad(\mess)=$};
	\draw[fill=Fuchsia!20,thick,inner sep=2ex] (0,0) rectangle (16,1);

	%% Separations in the message
	\draw[thick] ++( 4,0) -- ++(0,1); \path (   2,0.5) node {$\messblock_{0}$};
	\draw[thick] ++( 8,0) -- ++(0,1); \path ( 4+2,0.5) node {$\messblock_{1}$};
	\draw[thick] ++(12,0) -- ++(0,1); \path ( 8+2,0.5) node {$\messblock_{2}$};
	\draw[thick] ++(16,0) -- ++(0,1); \path (12+2,0.5) node {$\messblock_{3}$};

	%% Compressions functions 
	\begin{scope}[shift={(0.5,-4)}]
		\node [draw,trapezium,trapezium left angle=70,trapezium right angle=70,minimum height=0.7cm,thick,fill=YellowOrange!30,shift={(1.15,0.4)},rotate=-90] 
		{\begin{sideways}$\compress$\end{sideways}};
		\draw[->,thick] ++(1.5,+4) -- ++(0,-2.5) -- ++(0.5,0);
		\draw[->,thick] ++(0,0.5) node[left] {$\chain_{0}=\iv$}-- ++(2,0);
	\end{scope}

	\begin{scope}[shift={(4.5,-4)}]
		\node [draw,trapezium,trapezium left angle=70,trapezium right angle=70,minimum height=0.7cm,thick,fill=YellowOrange!30,shift={(1.15,0.4)},rotate=-90] 
		{\begin{sideways}$\compress$\end{sideways}};
		\draw[->,thick] ++(1.5,+4) -- ++(0,-2.5) -- ++(0.5,0);
		\draw[->,thick] ++(-0.2,0.5) -- node[below] {$\chain_{1}$} ++(2.2,0);
	\end{scope}

	\begin{scope}[shift={(8.5,-4)}]
		\node [draw,trapezium,trapezium left angle=70,trapezium right angle=70,minimum height=0.7cm,thick,fill=YellowOrange!30,shift={(1.15,0.4)},rotate=-90] 
		{\begin{sideways}$\compress$\end{sideways}};
		\draw[->,thick] ++(1.5,+4) -- ++(0,-2.5) -- ++(0.5,0);
		\draw[->,thick] ++(-0.2,0.5) -- node[below] {$\chain_{2}$} ++(2.2,0);
	\end{scope}

	\begin{scope}[shift={(12.5,-4)}]
		\node [draw,trapezium,trapezium left angle=70,trapezium right angle=70,minimum height=0.7cm,thick,fill=YellowOrange!30,shift={(1.15,0.4)},rotate=-90] 
		{\begin{sideways}$\compress$\end{sideways}};
		\draw[->,thick] ++(1.5,+4) -- ++(0,-2.5) -- ++(0.5,0);
		\draw[->,thick] ++(-0.2,0.5) -- node[below] {$\chain_{3}$} ++(2.2,0);
	\end{scope}

	\begin{scope}[shift={(16.5,-4)}]
		\draw[->,thick] ++(-0.2,0.5) -- ++(0.75,0) node[right] {$\chain_4 = \hash(\mess)$} ;
	\end{scope}
	
\end{tikzpicture}
%\end{document}
